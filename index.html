<!DOCTYPE html>
<html lang="en">
<head>
<title>Talon Practice</title>
<link rel="stylesheet" href="styles.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.min.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<div class="template-elements">
	<div id="template-lesson-choice" class="lesson-choice">
		<h3>{{TITLE}}</h3>
		<p>{{DESCRIPTION}}</p>
	</div>
</div>

<header>
	<h1>Talon practice</h1>
	<p>This is a webpage designed to help practice your Talon Voice usage. You can use it with a mouse or using Talon commands.</p>
	<p>If you want to choose a lesson, say <span style="color: yellow">tab</span>. From here, you can say <span style="color: yellow">go right</span> to move to the next lesson, and <span style="color: yellow">go left</span> to go to the previous one.</p>
	<p> Saying <span style="color: yellow">enter</span> or <span style="color: yellow">slap</span> will open the lesson.</p>	
	
	<h2>Choose a lesson</h2>	
</header>

<div id="lesson-choices"></div>
    
<script>
	var alphabetLesson = {
		title: "Talon Alphabet",
		description: "Learn the Talon alphabet.",
		startingContent: "",
		expectedContent: "abcdefghijklmnopqrstuvwxyz",
		startingScore: 2000,
		expectedChanges: 26,
		expectedSeconds: 60,
		link: 'lessons/alphabet.html'
	};
	
	var specialCharacterLesson = {
		title: "Special characters",
		description: "Get comfortable with most of the special characters used in programming.",
		startingContent: "",
		expectedContent: "{}()[]:;,.?!<>=_-+*'\"/\$%^&|",
		startingScore: 2000,
		expectedChanges: 26,
		expectedSeconds: 120,
		link: 'lessons/special_characters.html'
	};
	
	var fixingMistakesLesson = {
		title: "Dictation and fixing mistakes",
		description: "Learn to dictate sentences and words, and fix mistakes as you come accross them.",
		startingContent: "This is getting rather windy",
		expectedContent: "{}()[]:;,.?!<>=_-+*'\"/\$%^&|",
		startingScore: 2000,
		expectedChanges: 26,
		expectedSeconds: 120,
		link: 'lessons/fixing_mistakes.html'
	};
	
	var gotoLesson = function(lesson) {
		window.open(lesson.link, '_blank');
	};
	
	var lessons = [alphabetLesson, specialCharacterLesson, fixingMistakesLesson];
	var lessonKeypress = function(lesson) {
		return function(event) {
			if (event.keyCode === 37 || event.keyCode === 39) {
				var lessonList = Array.prototype.slice.call( event.target.parentNode.children );
				var direction = event.keyCode === 37 ? -1 : 1;
				var nextElementIndex = lessonList.indexOf( event.target ) + direction;
				
				if (nextElementIndex > -1 && nextElementIndex < lessonList.length ) {
					lessonList[nextElementIndex].focus();
				}
			} else if (event.keyCode === 13) {
				event.target.classList.add('selected');
				
				window.setTimeout(function(){
					gotoLesson(lesson);
				}, 300);
			}
		};
	}

	var lessonChoicesElement = document.getElementById("lesson-choices");
	var lessonTemplateElementString = document.getElementById("template-lesson-choice").outerHTML;
	lessons.forEach(function( lesson ){
		lessonChoicesElement.insertAdjacentHTML('beforeend', lessonTemplateElementString
			.replace('id="template-lesson-choice"', '')
			.replace("{{TITLE}}", lesson.title)
			.replace("{{DESCRIPTION}}", lesson.description));
		var lessonChoice = lessonChoicesElement.lastChild;
		lessonChoice.setAttribute('tabindex', "0");
		lessonChoice.addEventListener('keyup', lessonKeypress(lesson));
		lessonChoice.addEventListener('click', function() {
			return gotoLesson(lesson);
		});
	});

</script>
</body>
</html>
